-c-o-n-s-t- -e-x-p-r-e-s-s-=-r-e-q-u-i-r-e-(-"-e-x-p-r-e-s-s-"-)-;-c-o-n-s-t- -r-o-u-t-e-r-=-e-x-p-r-e-s-s-.-R-o-u-t-e-r-(-)-;--
-c-o-n-s-t- -{-v-e-r-i-f-y-I-n-i-t-D-a-t-a-,-m-a-k-e-D-e-v-I-n-i-t-D-a-t-a-,-p-a-r-s-e-I-n-i-t-D-a-t-a-}-=-r-e-q-u-i-r-e-(-"-.-.-/-u-t-i-l-s-/-t-e-l-e-g-r-a-m-A-u-t-h-"-)-;--
-c-o-n-s-t- -r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-=-r-e-q-u-i-r-e-(-"-.-.-/-m-i-d-d-l-e-w-a-r-e-/-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-"-)-;--
-c-o-n-s-t- -{-c-r-e-a-t-e-S-e-s-s-i-o-n-,-r-e-f-r-e-s-h-S-e-s-s-i-o-n-,-g-e-t-V-i-e-w-e-r-D-a-t-a-}-=-r-e-q-u-i-r-e-(-"-.-.-/-s-e-r-v-i-c-e-s-/-s-e-s-s-i-o-n-S-e-r-v-i-c-e-"-)-;--
-c-o-n-s-t- -{-e-n-s-u-r-e-R-e-n-d-e-r-e-d-,-l-i-s-t-P-a-g-e-s-,-m-a-k-e-S-v-g-}-=-r-e-q-u-i-r-e-(-"-.-.-/-s-e-r-v-i-c-e-s-/-r-e-n-d-e-r-S-e-r-v-i-c-e-"-)-;--
-c-o-n-s-t- -B-O-T-_-T-O-K-E-N-=-p-r-o-c-e-s-s-.-e-n-v-.-T-E-L-E-G-R-A-M-_-B-O-T-_-T-O-K-E-N-;--
-c-o-n-s-t- -A-L-L-O-W-_-D-E-V-=-(-p-r-o-c-e-s-s-.-e-n-v-.-A-L-L-O-W-_-D-E-V-_-I-N-I-T-D-A-T-A-|-|-"-f-a-l-s-e-"-)-.-t-o-L-o-w-e-r-C-a-s-e-(-)-=-=-=-"-t-r-u-e-"-;--
-c-o-n-s-t- -I-N-I-T-D-A-T-A-_-T-T-L-_-S-E-C-O-N-D-S-=-N-u-m-b-e-r-(-p-r-o-c-e-s-s-.-e-n-v-.-I-N-I-T-D-A-T-A-_-T-T-L-_-S-E-C-O-N-D-S-|-|-8-6-4-0-0-)-;--
--
-r-o-u-t-e-r-.-g-e-t-(-"-/-t-g-/-d-e-v---i-n-i-t-d-a-t-a-"-,-(-_-q-,-r-)-=->-A-L-L-O-W-_-D-E-V-?-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-i-n-i-t-D-a-t-a-:-m-a-k-e-D-e-v-I-n-i-t-D-a-t-a-(-)-}-)-:-r-.-s-t-a-t-u-s-(-4-0-3-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-"-d-e-v-_-d-i-s-a-b-l-e-d-"-}-)-)-;--
-r-o-u-t-e-r-.-p-o-s-t-(-"-/-t-g-"-,-(-q-,-r-)-=->-{-t-r-y-{-c-o-n-s-t- -{-i-n-i-t-D-a-t-a-}-=-q-.-b-o-d-y-|-|-{-}-;-i-f-(-!-i-n-i-t-D-a-t-a-)-r-e-t-u-r-n- -r-.-s-t-a-t-u-s-(-4-0-0-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-"-n-o-_-i-n-i-t-"-}-)-;-i-f-(-A-L-L-O-W-_-D-E-V-)-{-c-o-n-s-t- -p-=-p-a-r-s-e-I-n-i-t-D-a-t-a-(-i-n-i-t-D-a-t-a-)-;-i-f-(-p-.-h-a-s-h-=-=-=-"-F-A-K-E-H-A-S-H-_-D-E-V-_-O-N-L-Y-"-)-{-c-o-n-s-t- -s-=-p-.-u-s-e-r-?-.-i-d-|-|-"-d-e-v-"-;-r-e-t-u-r-n- -r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-s-u-b-:-s-,-.-.-.-c-r-e-a-t-e-S-e-s-s-i-o-n-(-s-)-}-)-;-}-}--
-c-o-n-s-t- -v-=-v-e-r-i-f-y-I-n-i-t-D-a-t-a-(-i-n-i-t-D-a-t-a-,-B-O-T-_-T-O-K-E-N-,-I-N-I-T-D-A-T-A-_-T-T-L-_-S-E-C-O-N-D-S-)-;-i-f-(-!-v-.-o-k-)-r-e-t-u-r-n- -r-.-s-t-a-t-u-s-(-4-0-1-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-v-.-r-e-a-s-o-n-}-)-;-c-o-n-s-t- -s-=-v-.-d-a-t-a-.-u-s-e-r-?-.-i-d-|-|-"-u-n-k-n-o-w-n-"-;-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-s-u-b-:-s-,-.-.-.-c-r-e-a-t-e-S-e-s-s-i-o-n-(-s-)-}-)-;-}-c-a-t-c-h-(-e-)-{-r-.-s-t-a-t-u-s-(-5-0-0-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-e-.-m-e-s-s-a-g-e-}-)-;-}-}-)-;--
-r-o-u-t-e-r-.-p-o-s-t-(-"-/-s-e-s-s-i-o-n-/-s-t-a-r-t-"-,-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-,-(-q-,-r-)-=->-{-c-o-n-s-t- -{-s-u-b-}-=-q-.-u-s-e-r-;-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-r-e-f-r-e-s-h-T-o-k-e-n-:-c-r-e-a-t-e-S-e-s-s-i-o-n-(-s-u-b-)-.-r-e-f-r-e-s-h-T-o-k-e-n-}-)-;-}-)-;--
-r-o-u-t-e-r-.-p-o-s-t-(-"-/-s-e-s-s-i-o-n-/-r-e-f-r-e-s-h-"-,-(-q-,-r-)-=->-{-c-o-n-s-t- -{-r-e-f-r-e-s-h-T-o-k-e-n-}-=-q-.-b-o-d-y-|-|-{-}-;-i-f-(-!-r-e-f-r-e-s-h-T-o-k-e-n-)-r-e-t-u-r-n- -r-.-s-t-a-t-u-s-(-4-0-0-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-"-n-o-_-r-e-f-r-e-s-h-"-}-)-;-t-r-y-{-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-.-.-.-r-e-f-r-e-s-h-S-e-s-s-i-o-n-(-r-e-f-r-e-s-h-T-o-k-e-n-)-}-)-;-}-c-a-t-c-h-(-e-)-{-r-.-s-t-a-t-u-s-(-e-.-s-t-a-t-u-s-|-|-5-0-0-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-e-.-m-e-s-s-a-g-e-}-)-;-}-}-)-;--
-r-o-u-t-e-r-.-g-e-t-(-"-/-v-i-e-w-e-r-/-d-a-t-a-/-:-t-o-k-e-n-"-,-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-,-(-q-,-r-)-=->-{-c-o-n-s-t- -{-s-u-b-}-=-q-.-u-s-e-r-;-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-s-u-b-,-d-a-t-a-:-g-e-t-V-i-e-w-e-r-D-a-t-a-(-s-u-b-)-,-t-o-k-e-n-:-q-.-p-a-r-a-m-s-.-t-o-k-e-n-}-)-;-}-)-;--
-r-o-u-t-e-r-.-g-e-t-(-"-/-c-o-n-t-e-n-t-/-p-a-g-e-s-/-:-t-o-k-e-n-"-,-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-,-(-q-,-r-)-=->-{-e-n-s-u-r-e-R-e-n-d-e-r-e-d-(-q-.-p-a-r-a-m-s-.-t-o-k-e-n-)-;-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-,-p-a-g-e-s-:-l-i-s-t-P-a-g-e-s-(-q-.-p-a-r-a-m-s-.-t-o-k-e-n-)-}-)-;-}-)-;--
-r-o-u-t-e-r-.-g-e-t-(-"-/-c-o-n-t-e-n-t-/-p-a-g-e---s-v-g-/-:-t-o-k-e-n-/-:-n-"-,-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-,-(-q-,-r-)-=->-{-c-o-n-s-t- -n-=-N-u-m-b-e-r-(-q-.-p-a-r-a-m-s-.-n-|-|-1-)-;-r-.-t-y-p-e-(-"-i-m-a-g-e-/-s-v-g-+-x-m-l-"-)-.-s-e-n-d-(-m-a-k-e-S-v-g-(-n-,-q-.-u-s-e-r-?-.-s-u-b-)-)-;-}-)-;--
-r-o-u-t-e-r-.-g-e-t-(-"-/-c-o-n-t-e-n-t-/-p-a-g-e---p-n-g-/-:-t-o-k-e-n-/-:-n-"-,-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-,-(-_-q-,-r-)-=->-r-.-s-t-a-t-u-s-(-5-0-1-)-.-j-s-o-n-(-{-o-k-:-f-a-l-s-e-,-e-r-r-o-r-:-"-p-n-g-_-n-o-t-_-i-m-p-l-e-m-e-n-t-e-d-"-}-)-)-;--
-r-o-u-t-e-r-.-p-o-s-t-(-"-/-v-i-e-w-e-r-/-s-c-r-e-e-n-s-h-o-t-"-,-r-e-q-u-i-r-e-C-l-i-e-n-t-A-u-t-h-,-(-q-,-r-)-=->-{-c-o-n-s-o-l-e-.-l-o-g-(-"-s-c-r-e-e-n-s-h-o-t-"-,-q-.-b-o-d-y-)-;-r-.-j-s-o-n-(-{-o-k-:-t-r-u-e-}-)-;-}-)-;--
-m-o-d-u-l-e-.-e-x-p-o-r-t-s-=-r-o-u-t-e-r-;--
-
